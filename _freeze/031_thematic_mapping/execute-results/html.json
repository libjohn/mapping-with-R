{
  "hash": "1147ca87e29384678b4d7e3016550aba",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Thematic Mapping with tmap\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)       # Tidyverse for Tidy Data\nlibrary(readxl)\nlibrary(tmap)            # Thematic Mapping\nlibrary(tmaptools) \nlibrary(tigris)          # Get Census Geography Poloygons\nlibrary(sf)\n```\n:::\n\n\n## Shapefiles as sf\n\nUsing the `tigris` package, get Census Tiger shapefiles for census geographies. Tigris will return the shapefile in the `sf`, or simple features, format.\n\n```         \nus_geo <- tigris::states(class = \"sf\") \n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_geo <- tigris::states(class = \"sf\") \n```\n:::\n\n\n## Data Structure\n\nThe \"Simple Features\" (`sf`) data structure can easily be viewed and manipulated as a rectangular data frame, before visualizing. As an historical note -- an `sf` predecessor -- the `sp` data structure uses `@data` slots to hold data. We'll focus on the `sf` package. Below are two methods of viewing the structure of the downloaded shapefiles.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(us_geo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sf\"         \"data.frame\"\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(us_geo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 56\nColumns: 15\n$ REGION   <chr> \"3\", \"3\", \"2\", \"2\", \"3\", \"1\", \"4\", \"1\", \"3\", \"1\", \"1\", \"3\", \"…\n$ DIVISION <chr> \"5\", \"5\", \"3\", \"4\", \"5\", \"1\", \"8\", \"1\", \"5\", \"1\", \"1\", \"5\", \"…\n$ STATEFP  <chr> \"54\", \"12\", \"17\", \"27\", \"24\", \"44\", \"16\", \"33\", \"37\", \"50\", \"…\n$ STATENS  <chr> \"01779805\", \"00294478\", \"01779784\", \"00662849\", \"01714934\", \"…\n$ GEOID    <chr> \"54\", \"12\", \"17\", \"27\", \"24\", \"44\", \"16\", \"33\", \"37\", \"50\", \"…\n$ STUSPS   <chr> \"WV\", \"FL\", \"IL\", \"MN\", \"MD\", \"RI\", \"ID\", \"NH\", \"NC\", \"VT\", \"…\n$ NAME     <chr> \"West Virginia\", \"Florida\", \"Illinois\", \"Minnesota\", \"Marylan…\n$ LSAD     <chr> \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"…\n$ MTFCC    <chr> \"G4000\", \"G4000\", \"G4000\", \"G4000\", \"G4000\", \"G4000\", \"G4000\"…\n$ FUNCSTAT <chr> \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"…\n$ ALAND    <dbl> 62266298634, 138961722096, 143778561906, 206232627084, 251519…\n$ AWATER   <dbl> 489204185, 45972570361, 6216493488, 18949394733, 6979074857, …\n$ INTPTLAT <chr> \"+38.6472854\", \"+28.3989775\", \"+40.1028754\", \"+46.3159573\", \"…\n$ INTPTLON <chr> \"-080.6183274\", \"-082.5143005\", \"-089.1526108\", \"-094.1996043…\n$ geometry <MULTIPOLYGON [°]> MULTIPOLYGON (((-80.85847 3..., MULTIPOLYGON (((…\n```\n\n\n:::\n:::\n\n\n## sf as data frame\n\nAnd as noted, here's the data frame view. Notice the geometry (polygon shape) in the far-right column of the data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nas_tibble(us_geo)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"REGION\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"DIVISION\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"STATEFP\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"STATENS\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"GEOID\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"STUSPS\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"NAME\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"LSAD\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"MTFCC\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"FUNCSTAT\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"ALAND\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AWATER\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"INTPTLAT\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"INTPTLON\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"geometry\"],\"name\":[15],\"type\":[\"s_MULTIP\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3\",\"2\":\"5\",\"3\":\"54\",\"4\":\"01779805\",\"5\":\"54\",\"6\":\"WV\",\"7\":\"West Virginia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"6.226630e+10\",\"12\":\"489204185\",\"13\":\"+38.6472854\",\"14\":\"-080.6183274\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"12\",\"4\":\"00294478\",\"5\":\"12\",\"6\":\"FL\",\"7\":\"Florida\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.389617e+11\",\"12\":\"45972570361\",\"13\":\"+28.3989775\",\"14\":\"-082.5143005\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"17\",\"4\":\"01779784\",\"5\":\"17\",\"6\":\"IL\",\"7\":\"Illinois\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.437786e+11\",\"12\":\"6216493488\",\"13\":\"+40.1028754\",\"14\":\"-089.1526108\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"27\",\"4\":\"00662849\",\"5\":\"27\",\"6\":\"MN\",\"7\":\"Minnesota\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.062326e+11\",\"12\":\"18949394733\",\"13\":\"+46.3159573\",\"14\":\"-094.1996043\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"24\",\"4\":\"01714934\",\"5\":\"24\",\"6\":\"MD\",\"7\":\"Maryland\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.515199e+10\",\"12\":\"6979074857\",\"13\":\"+38.9466584\",\"14\":\"-076.6744939\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"44\",\"4\":\"01219835\",\"5\":\"44\",\"6\":\"RI\",\"7\":\"Rhode Island\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.677763e+09\",\"12\":\"1323686988\",\"13\":\"+41.5964850\",\"14\":\"-071.5264901\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"16\",\"4\":\"01779783\",\"5\":\"16\",\"6\":\"ID\",\"7\":\"Idaho\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.140499e+11\",\"12\":\"2391569647\",\"13\":\"+44.3484222\",\"14\":\"-114.5588538\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"33\",\"4\":\"01779794\",\"5\":\"33\",\"6\":\"NH\",\"7\":\"New Hampshire\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.319012e+10\",\"12\":\"1025971768\",\"13\":\"+43.6726907\",\"14\":\"-071.5843145\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"37\",\"4\":\"01027616\",\"5\":\"37\",\"6\":\"NC\",\"7\":\"North Carolina\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.259333e+11\",\"12\":\"13456093195\",\"13\":\"+35.5397100\",\"14\":\"-079.1308636\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"50\",\"4\":\"01779802\",\"5\":\"50\",\"6\":\"VT\",\"7\":\"Vermont\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.387257e+10\",\"12\":\"1030754609\",\"13\":\"+44.0589536\",\"14\":\"-072.6710173\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"09\",\"4\":\"01779780\",\"5\":\"09\",\"6\":\"CT\",\"7\":\"Connecticut\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.254169e+10\",\"12\":\"1816424193\",\"13\":\"+41.5798637\",\"14\":\"-072.7466572\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"10\",\"4\":\"01779781\",\"5\":\"10\",\"6\":\"DE\",\"7\":\"Delaware\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"5.046732e+09\",\"12\":\"1399179670\",\"13\":\"+38.9985661\",\"14\":\"-075.4416440\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"35\",\"4\":\"00897535\",\"5\":\"35\",\"6\":\"NM\",\"7\":\"New Mexico\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"3.141986e+11\",\"12\":\"726482113\",\"13\":\"+34.4346843\",\"14\":\"-106.1316181\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"06\",\"4\":\"01779778\",\"5\":\"06\",\"6\":\"CA\",\"7\":\"California\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"4.036718e+11\",\"12\":\"20293573058\",\"13\":\"+37.1551773\",\"14\":\"-119.5434183\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"34\",\"4\":\"01779795\",\"5\":\"34\",\"6\":\"NJ\",\"7\":\"New Jersey\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.904892e+10\",\"12\":\"3533083369\",\"13\":\"+40.1072744\",\"14\":\"-074.6652012\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"55\",\"4\":\"01779806\",\"5\":\"55\",\"6\":\"WI\",\"7\":\"Wisconsin\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.402923e+11\",\"12\":\"29343646672\",\"13\":\"+44.6309071\",\"14\":\"-089.7093916\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"41\",\"4\":\"01155107\",\"5\":\"41\",\"6\":\"OR\",\"7\":\"Oregon\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.486284e+11\",\"12\":\"6170965739\",\"13\":\"+43.9717125\",\"14\":\"-120.6229578\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"31\",\"4\":\"01779792\",\"5\":\"31\",\"6\":\"NE\",\"7\":\"Nebraska\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.989574e+11\",\"12\":\"1371105730\",\"13\":\"+41.5433053\",\"14\":\"-099.8118646\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"42\",\"4\":\"01779798\",\"5\":\"42\",\"6\":\"PA\",\"7\":\"Pennsylvania\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.158818e+11\",\"12\":\"3397909903\",\"13\":\"+40.9046013\",\"14\":\"-077.8275298\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"53\",\"4\":\"01779804\",\"5\":\"53\",\"6\":\"WA\",\"7\":\"Washington\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.721190e+11\",\"12\":\"12548738684\",\"13\":\"+47.4073238\",\"14\":\"-120.5757999\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"22\",\"4\":\"01629543\",\"5\":\"22\",\"6\":\"LA\",\"7\":\"Louisiana\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.119153e+11\",\"12\":\"23736382213\",\"13\":\"+30.8634368\",\"14\":\"-091.7987173\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"13\",\"4\":\"01705317\",\"5\":\"13\",\"6\":\"GA\",\"7\":\"Georgia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.494866e+11\",\"12\":\"4418360134\",\"13\":\"+32.6295789\",\"14\":\"-083.4235109\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"01\",\"4\":\"01779775\",\"5\":\"01\",\"6\":\"AL\",\"7\":\"Alabama\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.311755e+11\",\"12\":\"4591897964\",\"13\":\"+32.7396323\",\"14\":\"-086.8434593\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"49\",\"4\":\"01455989\",\"5\":\"49\",\"6\":\"UT\",\"7\":\"Utah\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.133551e+11\",\"12\":\"6529973239\",\"13\":\"+39.3349925\",\"14\":\"-111.6563326\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"39\",\"4\":\"01085497\",\"5\":\"39\",\"6\":\"OH\",\"7\":\"Ohio\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.058237e+11\",\"12\":\"10274702852\",\"13\":\"+40.4149297\",\"14\":\"-082.7119975\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"48\",\"4\":\"01779801\",\"5\":\"48\",\"6\":\"TX\",\"7\":\"Texas\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"6.766816e+11\",\"12\":\"18978390713\",\"13\":\"+31.4347032\",\"14\":\"-099.2818238\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"08\",\"4\":\"01779779\",\"5\":\"08\",\"6\":\"CO\",\"7\":\"Colorado\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.684188e+11\",\"12\":\"1185716938\",\"13\":\"+38.9937669\",\"14\":\"-105.5087122\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"45\",\"4\":\"01779799\",\"5\":\"45\",\"6\":\"SC\",\"7\":\"South Carolina\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"7.786620e+10\",\"12\":\"5074243221\",\"13\":\"+33.8741776\",\"14\":\"-080.8542639\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"40\",\"4\":\"01102857\",\"5\":\"40\",\"6\":\"OK\",\"7\":\"Oklahoma\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.776642e+11\",\"12\":\"3373725677\",\"13\":\"+35.5900815\",\"14\":\"-097.4867789\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"47\",\"4\":\"01325873\",\"5\":\"47\",\"6\":\"TN\",\"7\":\"Tennessee\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.067920e+11\",\"12\":\"2322601737\",\"13\":\"+35.8584600\",\"14\":\"-086.3496339\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"56\",\"4\":\"01779807\",\"5\":\"56\",\"6\":\"WY\",\"7\":\"Wyoming\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.514587e+11\",\"12\":\"1867503716\",\"13\":\"+42.9896591\",\"14\":\"-107.5443922\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"15\",\"4\":\"01779782\",\"5\":\"15\",\"6\":\"HI\",\"7\":\"Hawaii\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.663415e+10\",\"12\":\"11777652105\",\"13\":\"+19.8281671\",\"14\":\"-155.4950421\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"38\",\"4\":\"01779797\",\"5\":\"38\",\"6\":\"ND\",\"7\":\"North Dakota\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.786943e+11\",\"12\":\"4414779956\",\"13\":\"+47.4421740\",\"14\":\"-100.4608258\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"21\",\"4\":\"01779786\",\"5\":\"21\",\"6\":\"KY\",\"7\":\"Kentucky\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.022830e+11\",\"12\":\"2367816964\",\"13\":\"+37.5336844\",\"14\":\"-085.2929801\",\"15\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"78\",\"4\":\"01802710\",\"5\":\"78\",\"6\":\"VI\",\"7\":\"United States Virgin Islands\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"3.480219e+08\",\"12\":\"1550236187\",\"13\":\"+18.3392359\",\"14\":\"-064.9500433\",\"15\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"69\",\"4\":\"01779809\",\"5\":\"69\",\"6\":\"MP\",\"7\":\"Commonwealth of the Northern Mariana Islands\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"4.722925e+08\",\"12\":\"4644252458\",\"13\":\"+15.0010865\",\"14\":\"+145.6181702\",\"15\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"66\",\"4\":\"01802705\",\"5\":\"66\",\"6\":\"GU\",\"7\":\"Guam\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"5.435558e+08\",\"12\":\"934337453\",\"13\":\"+13.4417451\",\"14\":\"+144.7719021\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"23\",\"4\":\"01779787\",\"5\":\"23\",\"6\":\"ME\",\"7\":\"Maine\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"7.988826e+10\",\"12\":\"11745102727\",\"13\":\"+45.4092843\",\"14\":\"-068.6666160\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"36\",\"4\":\"01779796\",\"5\":\"36\",\"6\":\"NY\",\"7\":\"New York\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.220491e+11\",\"12\":\"19257128505\",\"13\":\"+42.9133974\",\"14\":\"-075.5962723\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"32\",\"4\":\"01779793\",\"5\":\"32\",\"6\":\"NV\",\"7\":\"Nevada\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.845373e+11\",\"12\":\"1839636284\",\"13\":\"+39.3310928\",\"14\":\"-116.6151469\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"02\",\"4\":\"01785533\",\"5\":\"02\",\"6\":\"AK\",\"7\":\"Alaska\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.478943e+12\",\"12\":\"245378425142\",\"13\":\"+63.3473560\",\"14\":\"-152.8397334\",\"15\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"60\",\"4\":\"01802701\",\"5\":\"60\",\"6\":\"AS\",\"7\":\"American Samoa\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.977591e+08\",\"12\":\"1307243751\",\"13\":\"-14.2671590\",\"14\":\"-170.6682674\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"26\",\"4\":\"01779789\",\"5\":\"26\",\"6\":\"MI\",\"7\":\"Michigan\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.466149e+11\",\"12\":\"103871870536\",\"13\":\"+44.8441768\",\"14\":\"-085.6604907\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"05\",\"4\":\"00068085\",\"5\":\"05\",\"6\":\"AR\",\"7\":\"Arkansas\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.346608e+11\",\"12\":\"3121950081\",\"13\":\"+34.8955256\",\"14\":\"-092.4446262\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"28\",\"4\":\"01779790\",\"5\":\"28\",\"6\":\"MS\",\"7\":\"Mississippi\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.215339e+11\",\"12\":\"3914344129\",\"13\":\"+32.6864714\",\"14\":\"-089.6561377\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"29\",\"4\":\"01779791\",\"5\":\"29\",\"6\":\"MO\",\"7\":\"Missouri\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.780523e+11\",\"12\":\"2487445715\",\"13\":\"+38.3507500\",\"14\":\"-092.4567826\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"30\",\"4\":\"00767982\",\"5\":\"30\",\"6\":\"MT\",\"7\":\"Montana\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"3.769737e+11\",\"12\":\"3866634365\",\"13\":\"+47.0511770\",\"14\":\"-109.6348174\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"20\",\"4\":\"00481813\",\"5\":\"20\",\"6\":\"KS\",\"7\":\"Kansas\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.117537e+11\",\"12\":\"1345767737\",\"13\":\"+38.4985464\",\"14\":\"-098.3834298\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"18\",\"4\":\"00448508\",\"5\":\"18\",\"6\":\"IN\",\"7\":\"Indiana\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"9.278936e+10\",\"12\":\"1541248299\",\"13\":\"+39.9013136\",\"14\":\"-086.2919129\",\"15\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"72\",\"4\":\"01779808\",\"5\":\"72\",\"6\":\"PR\",\"7\":\"Puerto Rico\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"8.869136e+09\",\"12\":\"4922143005\",\"13\":\"+18.2176480\",\"14\":\"-066.4107992\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"46\",\"4\":\"01785534\",\"5\":\"46\",\"6\":\"SD\",\"7\":\"South Dakota\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.963429e+11\",\"12\":\"3386737669\",\"13\":\"+44.4467957\",\"14\":\"-100.2381762\",\"15\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"25\",\"4\":\"00606926\",\"5\":\"25\",\"6\":\"MA\",\"7\":\"Massachusetts\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.020439e+10\",\"12\":\"7130660432\",\"13\":\"+42.1565196\",\"14\":\"-071.4895915\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"51\",\"4\":\"01779803\",\"5\":\"51\",\"6\":\"VA\",\"7\":\"Virginia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.022582e+11\",\"12\":\"8528040726\",\"13\":\"+37.5222512\",\"14\":\"-078.6681938\",\"15\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"11\",\"4\":\"01702382\",\"5\":\"11\",\"6\":\"DC\",\"7\":\"District of Columbia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.583161e+08\",\"12\":\"18709762\",\"13\":\"+38.9042474\",\"14\":\"-077.0165167\",\"15\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"19\",\"4\":\"01779785\",\"5\":\"19\",\"6\":\"IA\",\"7\":\"Iowa\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.446597e+11\",\"12\":\"1085964740\",\"13\":\"+42.0700243\",\"14\":\"-093.4933473\",\"15\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"04\",\"4\":\"01779777\",\"5\":\"04\",\"6\":\"AZ\",\"7\":\"Arizona\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.943640e+11\",\"12\":\"855871553\",\"13\":\"+34.2039362\",\"14\":\"-111.6063449\",\"15\":\"<s_MULTIP>\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Quick Plotting\n\nIf you want to see a very quick view of your mapping data, you can plot the geometry data with the `plot` function. In this case we use the `sf::st_geometry()` function to plot only the geometry. You can quickly generate a faceted map by excluding the `st_geometry` function: e.g. `plot(us_geo)` but that will consume computation cycles (i.e. wait time). Therefore, I recommend trying the smaller layer for now.\n\n> **Note:** Census geography for the USA will span the globe in part becuase Region 9 includes a multitude of pacific islands. Later we will limit to simply the \"lower 48\" states.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(us_geo))\n```\n\n::: {.cell-output-display}\n![](031_thematic_mapping_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Get BLS data\n\nI've already downloaded and stored some data from the Bureau of Labor Statistics. Those data are stored in an excel file in the `data` directory of the [repository](https://github.com/libjohn/mapping-with-R): `data/OES_Report.xlsx`. **The goal is to attach this data to the previously downloaded shapefiles.**\n\nBut you may be interested in how I gathered the data. below are some summary notes documenting my steps of gathering the data from the Bureau of Labor Statistics.\n\nhttps://data.bls.gov/oes/#/occGeo/One%20occupation%20for%20multiple%20geographical%20areas\n\n-   One occupation for multiple geographical areas\n\n    -   Mental Health and Substance Abuse Social Workers\n\n        -   State\n\n        -   All States in this list\n\n        -   Annual Mean wage\n\n            -   Excel\n\n-   Read the Data in with the RStudio \"Import Dataset\" wizard available in the *Environment* tab. This will generate the code below and ensure the import\n\n    -   Skips the first 4 lines\n    -   Coerces the 2nd column to numeric\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalary4Helpers <- \n  read_excel(\"data/OES_Report.xlsx\",\n             col_types = c(\"text\", \"numeric\"), \n             skip = 4)\n\nSalary4Helpers\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Area Name\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Annual mean wage(2)\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Alabama(0100000)\",\"2\":\"38080\"},{\"1\":\"Alaska(0200000)\",\"2\":\"46050\"},{\"1\":\"Arizona(0400000)\",\"2\":\"34560\"},{\"1\":\"Arkansas(0500000)\",\"2\":\"40480\"},{\"1\":\"California(0600000)\",\"2\":\"64320\"},{\"1\":\"Colorado(0800000)\",\"2\":\"43480\"},{\"1\":\"Connecticut(0900000)\",\"2\":\"60450\"},{\"1\":\"Delaware(1000000)\",\"2\":\"54450\"},{\"1\":\"District of Columbia(1100000)\",\"2\":\"57210\"},{\"1\":\"Florida(1200000)\",\"2\":\"43410\"},{\"1\":\"Georgia(1300000)\",\"2\":\"52750\"},{\"1\":\"Guam(6600000)\",\"2\":\"40080\"},{\"1\":\"Hawaii(1500000)\",\"2\":\"57290\"},{\"1\":\"Idaho(1600000)\",\"2\":\"39580\"},{\"1\":\"Illinois(1700000)\",\"2\":\"53240\"},{\"1\":\"Indiana(1800000)\",\"2\":\"42100\"},{\"1\":\"Iowa(1900000)\",\"2\":\"45380\"},{\"1\":\"Kansas(2000000)\",\"2\":\"41050\"},{\"1\":\"Kentucky(2100000)\",\"2\":\"38130\"},{\"1\":\"Louisiana(2200000)\",\"2\":\"37270\"},{\"1\":\"Maine(2300000)\",\"2\":\"59360\"},{\"1\":\"Maryland(2400000)\",\"2\":\"47560\"},{\"1\":\"Massachusetts(2500000)\",\"2\":\"44960\"},{\"1\":\"Michigan(2600000)\",\"2\":\"49420\"},{\"1\":\"Minnesota(2700000)\",\"2\":\"49310\"},{\"1\":\"Mississippi(2800000)\",\"2\":\"34880\"},{\"1\":\"Missouri(2900000)\",\"2\":\"35510\"},{\"1\":\"Montana(3000000)\",\"2\":\"37710\"},{\"1\":\"Nebraska(3100000)\",\"2\":\"36620\"},{\"1\":\"Nevada(3200000)\",\"2\":\"57460\"},{\"1\":\"New Hampshire(3300000)\",\"2\":\"51320\"},{\"1\":\"New Jersey(3400000)\",\"2\":\"71600\"},{\"1\":\"New Mexico(3500000)\",\"2\":\"37420\"},{\"1\":\"New York(3600000)\",\"2\":\"56430\"},{\"1\":\"North Carolina(3700000)\",\"2\":\"46490\"},{\"1\":\"North Dakota(3800000)\",\"2\":\"50270\"},{\"1\":\"Ohio(3900000)\",\"2\":\"41190\"},{\"1\":\"Oklahoma(4000000)\",\"2\":\"35430\"},{\"1\":\"Oregon(4100000)\",\"2\":\"46330\"},{\"1\":\"Pennsylvania(4200000)\",\"2\":\"37600\"},{\"1\":\"Puerto Rico(7200000)\",\"2\":\"23050\"},{\"1\":\"Rhode Island(4400000)\",\"2\":\"47420\"},{\"1\":\"South Carolina(4500000)\",\"2\":\"34680\"},{\"1\":\"South Dakota(4600000)\",\"2\":\"36980\"},{\"1\":\"Tennessee(4700000)\",\"2\":\"35540\"},{\"1\":\"Texas(4800000)\",\"2\":\"42790\"},{\"1\":\"Utah(4900000)\",\"2\":\"47140\"},{\"1\":\"Vermont(5000000)\",\"2\":\"40150\"},{\"1\":\"Virginia(5100000)\",\"2\":\"49250\"},{\"1\":\"Washington(5300000)\",\"2\":\"51980\"},{\"1\":\"West Virginia(5400000)\",\"2\":\"30920\"},{\"1\":\"Wisconsin(5500000)\",\"2\":\"46220\"},{\"1\":\"Wyoming(5600000)\",\"2\":\"56110\"},{\"1\":\"NA\",\"2\":\"NA\"},{\"1\":\"(2)Annual wages have been calculated by multiplying the hourly mean wage by 2,080 hours.\",\"2\":\"NA\"},{\"1\":\"NA\",\"2\":\"NA\"},{\"1\":\"SOC code: Standard Occupational Classification code -- see http://www.bls.gov/soc/home.htm\",\"2\":\"NA\"},{\"1\":\"Date extracted on :Sep 25, 2017\",\"2\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Wrangle the data\n\nBefore we join the BLS data to the shapefile we need to transform the structure of the downloaded BLS data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBlsWage_ToJoin <- Salary4Helpers %>% \n  rename(Area = \"Area Name\") %>% \n  rename(wages = \"Annual mean wage(2)\") %>% \n  mutate(State = gsub(\"\\\\(\\\\d{7}\\\\)\", \"\", Area)) %>% \n  filter(wages != \"NA_character_\") %>% \n  select(State, wages)\n\n#BlsWage_ToJoin\n```\n:::\n\n\n## Join data\n\nUse the `dplyr::left_join()` function or the base-R `merge()` function to append BLS data to the previously loaded shape object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHelperShapeObject <- left_join(us_geo, BlsWage_ToJoin, by = c(\"NAME\" = \"State\"))\n\nas_tibble(HelperShapeObject)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"REGION\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"DIVISION\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"STATEFP\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"STATENS\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"GEOID\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"STUSPS\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"NAME\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"LSAD\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"MTFCC\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"FUNCSTAT\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"ALAND\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AWATER\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"INTPTLAT\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"INTPTLON\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"wages\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"geometry\"],\"name\":[16],\"type\":[\"s_MULTIP\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3\",\"2\":\"5\",\"3\":\"54\",\"4\":\"01779805\",\"5\":\"54\",\"6\":\"WV\",\"7\":\"West Virginia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"6.226630e+10\",\"12\":\"489204185\",\"13\":\"+38.6472854\",\"14\":\"-080.6183274\",\"15\":\"30920\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"12\",\"4\":\"00294478\",\"5\":\"12\",\"6\":\"FL\",\"7\":\"Florida\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.389617e+11\",\"12\":\"45972570361\",\"13\":\"+28.3989775\",\"14\":\"-082.5143005\",\"15\":\"43410\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"17\",\"4\":\"01779784\",\"5\":\"17\",\"6\":\"IL\",\"7\":\"Illinois\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.437786e+11\",\"12\":\"6216493488\",\"13\":\"+40.1028754\",\"14\":\"-089.1526108\",\"15\":\"53240\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"27\",\"4\":\"00662849\",\"5\":\"27\",\"6\":\"MN\",\"7\":\"Minnesota\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.062326e+11\",\"12\":\"18949394733\",\"13\":\"+46.3159573\",\"14\":\"-094.1996043\",\"15\":\"49310\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"24\",\"4\":\"01714934\",\"5\":\"24\",\"6\":\"MD\",\"7\":\"Maryland\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.515199e+10\",\"12\":\"6979074857\",\"13\":\"+38.9466584\",\"14\":\"-076.6744939\",\"15\":\"47560\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"44\",\"4\":\"01219835\",\"5\":\"44\",\"6\":\"RI\",\"7\":\"Rhode Island\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.677763e+09\",\"12\":\"1323686988\",\"13\":\"+41.5964850\",\"14\":\"-071.5264901\",\"15\":\"47420\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"16\",\"4\":\"01779783\",\"5\":\"16\",\"6\":\"ID\",\"7\":\"Idaho\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.140499e+11\",\"12\":\"2391569647\",\"13\":\"+44.3484222\",\"14\":\"-114.5588538\",\"15\":\"39580\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"33\",\"4\":\"01779794\",\"5\":\"33\",\"6\":\"NH\",\"7\":\"New Hampshire\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.319012e+10\",\"12\":\"1025971768\",\"13\":\"+43.6726907\",\"14\":\"-071.5843145\",\"15\":\"51320\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"37\",\"4\":\"01027616\",\"5\":\"37\",\"6\":\"NC\",\"7\":\"North Carolina\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.259333e+11\",\"12\":\"13456093195\",\"13\":\"+35.5397100\",\"14\":\"-079.1308636\",\"15\":\"46490\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"50\",\"4\":\"01779802\",\"5\":\"50\",\"6\":\"VT\",\"7\":\"Vermont\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.387257e+10\",\"12\":\"1030754609\",\"13\":\"+44.0589536\",\"14\":\"-072.6710173\",\"15\":\"40150\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"09\",\"4\":\"01779780\",\"5\":\"09\",\"6\":\"CT\",\"7\":\"Connecticut\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.254169e+10\",\"12\":\"1816424193\",\"13\":\"+41.5798637\",\"14\":\"-072.7466572\",\"15\":\"60450\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"10\",\"4\":\"01779781\",\"5\":\"10\",\"6\":\"DE\",\"7\":\"Delaware\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"5.046732e+09\",\"12\":\"1399179670\",\"13\":\"+38.9985661\",\"14\":\"-075.4416440\",\"15\":\"54450\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"35\",\"4\":\"00897535\",\"5\":\"35\",\"6\":\"NM\",\"7\":\"New Mexico\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"3.141986e+11\",\"12\":\"726482113\",\"13\":\"+34.4346843\",\"14\":\"-106.1316181\",\"15\":\"37420\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"06\",\"4\":\"01779778\",\"5\":\"06\",\"6\":\"CA\",\"7\":\"California\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"4.036718e+11\",\"12\":\"20293573058\",\"13\":\"+37.1551773\",\"14\":\"-119.5434183\",\"15\":\"64320\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"34\",\"4\":\"01779795\",\"5\":\"34\",\"6\":\"NJ\",\"7\":\"New Jersey\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.904892e+10\",\"12\":\"3533083369\",\"13\":\"+40.1072744\",\"14\":\"-074.6652012\",\"15\":\"71600\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"55\",\"4\":\"01779806\",\"5\":\"55\",\"6\":\"WI\",\"7\":\"Wisconsin\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.402923e+11\",\"12\":\"29343646672\",\"13\":\"+44.6309071\",\"14\":\"-089.7093916\",\"15\":\"46220\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"41\",\"4\":\"01155107\",\"5\":\"41\",\"6\":\"OR\",\"7\":\"Oregon\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.486284e+11\",\"12\":\"6170965739\",\"13\":\"+43.9717125\",\"14\":\"-120.6229578\",\"15\":\"46330\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"31\",\"4\":\"01779792\",\"5\":\"31\",\"6\":\"NE\",\"7\":\"Nebraska\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.989574e+11\",\"12\":\"1371105730\",\"13\":\"+41.5433053\",\"14\":\"-099.8118646\",\"15\":\"36620\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"42\",\"4\":\"01779798\",\"5\":\"42\",\"6\":\"PA\",\"7\":\"Pennsylvania\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.158818e+11\",\"12\":\"3397909903\",\"13\":\"+40.9046013\",\"14\":\"-077.8275298\",\"15\":\"37600\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"53\",\"4\":\"01779804\",\"5\":\"53\",\"6\":\"WA\",\"7\":\"Washington\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.721190e+11\",\"12\":\"12548738684\",\"13\":\"+47.4073238\",\"14\":\"-120.5757999\",\"15\":\"51980\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"22\",\"4\":\"01629543\",\"5\":\"22\",\"6\":\"LA\",\"7\":\"Louisiana\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.119153e+11\",\"12\":\"23736382213\",\"13\":\"+30.8634368\",\"14\":\"-091.7987173\",\"15\":\"37270\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"13\",\"4\":\"01705317\",\"5\":\"13\",\"6\":\"GA\",\"7\":\"Georgia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.494866e+11\",\"12\":\"4418360134\",\"13\":\"+32.6295789\",\"14\":\"-083.4235109\",\"15\":\"52750\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"01\",\"4\":\"01779775\",\"5\":\"01\",\"6\":\"AL\",\"7\":\"Alabama\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.311755e+11\",\"12\":\"4591897964\",\"13\":\"+32.7396323\",\"14\":\"-086.8434593\",\"15\":\"38080\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"49\",\"4\":\"01455989\",\"5\":\"49\",\"6\":\"UT\",\"7\":\"Utah\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.133551e+11\",\"12\":\"6529973239\",\"13\":\"+39.3349925\",\"14\":\"-111.6563326\",\"15\":\"47140\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"39\",\"4\":\"01085497\",\"5\":\"39\",\"6\":\"OH\",\"7\":\"Ohio\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.058237e+11\",\"12\":\"10274702852\",\"13\":\"+40.4149297\",\"14\":\"-082.7119975\",\"15\":\"41190\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"48\",\"4\":\"01779801\",\"5\":\"48\",\"6\":\"TX\",\"7\":\"Texas\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"6.766816e+11\",\"12\":\"18978390713\",\"13\":\"+31.4347032\",\"14\":\"-099.2818238\",\"15\":\"42790\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"08\",\"4\":\"01779779\",\"5\":\"08\",\"6\":\"CO\",\"7\":\"Colorado\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.684188e+11\",\"12\":\"1185716938\",\"13\":\"+38.9937669\",\"14\":\"-105.5087122\",\"15\":\"43480\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"45\",\"4\":\"01779799\",\"5\":\"45\",\"6\":\"SC\",\"7\":\"South Carolina\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"7.786620e+10\",\"12\":\"5074243221\",\"13\":\"+33.8741776\",\"14\":\"-080.8542639\",\"15\":\"34680\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"40\",\"4\":\"01102857\",\"5\":\"40\",\"6\":\"OK\",\"7\":\"Oklahoma\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.776642e+11\",\"12\":\"3373725677\",\"13\":\"+35.5900815\",\"14\":\"-097.4867789\",\"15\":\"35430\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"47\",\"4\":\"01325873\",\"5\":\"47\",\"6\":\"TN\",\"7\":\"Tennessee\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.067920e+11\",\"12\":\"2322601737\",\"13\":\"+35.8584600\",\"14\":\"-086.3496339\",\"15\":\"35540\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"56\",\"4\":\"01779807\",\"5\":\"56\",\"6\":\"WY\",\"7\":\"Wyoming\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.514587e+11\",\"12\":\"1867503716\",\"13\":\"+42.9896591\",\"14\":\"-107.5443922\",\"15\":\"56110\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"15\",\"4\":\"01779782\",\"5\":\"15\",\"6\":\"HI\",\"7\":\"Hawaii\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.663415e+10\",\"12\":\"11777652105\",\"13\":\"+19.8281671\",\"14\":\"-155.4950421\",\"15\":\"57290\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"38\",\"4\":\"01779797\",\"5\":\"38\",\"6\":\"ND\",\"7\":\"North Dakota\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.786943e+11\",\"12\":\"4414779956\",\"13\":\"+47.4421740\",\"14\":\"-100.4608258\",\"15\":\"50270\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"21\",\"4\":\"01779786\",\"5\":\"21\",\"6\":\"KY\",\"7\":\"Kentucky\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.022830e+11\",\"12\":\"2367816964\",\"13\":\"+37.5336844\",\"14\":\"-085.2929801\",\"15\":\"38130\",\"16\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"78\",\"4\":\"01802710\",\"5\":\"78\",\"6\":\"VI\",\"7\":\"United States Virgin Islands\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"3.480219e+08\",\"12\":\"1550236187\",\"13\":\"+18.3392359\",\"14\":\"-064.9500433\",\"15\":\"NA\",\"16\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"69\",\"4\":\"01779809\",\"5\":\"69\",\"6\":\"MP\",\"7\":\"Commonwealth of the Northern Mariana Islands\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"4.722925e+08\",\"12\":\"4644252458\",\"13\":\"+15.0010865\",\"14\":\"+145.6181702\",\"15\":\"NA\",\"16\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"66\",\"4\":\"01802705\",\"5\":\"66\",\"6\":\"GU\",\"7\":\"Guam\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"5.435558e+08\",\"12\":\"934337453\",\"13\":\"+13.4417451\",\"14\":\"+144.7719021\",\"15\":\"40080\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"23\",\"4\":\"01779787\",\"5\":\"23\",\"6\":\"ME\",\"7\":\"Maine\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"7.988826e+10\",\"12\":\"11745102727\",\"13\":\"+45.4092843\",\"14\":\"-068.6666160\",\"15\":\"59360\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"36\",\"4\":\"01779796\",\"5\":\"36\",\"6\":\"NY\",\"7\":\"New York\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.220491e+11\",\"12\":\"19257128505\",\"13\":\"+42.9133974\",\"14\":\"-075.5962723\",\"15\":\"56430\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"32\",\"4\":\"01779793\",\"5\":\"32\",\"6\":\"NV\",\"7\":\"Nevada\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.845373e+11\",\"12\":\"1839636284\",\"13\":\"+39.3310928\",\"14\":\"-116.6151469\",\"15\":\"57460\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"02\",\"4\":\"01785533\",\"5\":\"02\",\"6\":\"AK\",\"7\":\"Alaska\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.478943e+12\",\"12\":\"245378425142\",\"13\":\"+63.3473560\",\"14\":\"-152.8397334\",\"15\":\"46050\",\"16\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"60\",\"4\":\"01802701\",\"5\":\"60\",\"6\":\"AS\",\"7\":\"American Samoa\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.977591e+08\",\"12\":\"1307243751\",\"13\":\"-14.2671590\",\"14\":\"-170.6682674\",\"15\":\"NA\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"26\",\"4\":\"01779789\",\"5\":\"26\",\"6\":\"MI\",\"7\":\"Michigan\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.466149e+11\",\"12\":\"103871870536\",\"13\":\"+44.8441768\",\"14\":\"-085.6604907\",\"15\":\"49420\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"7\",\"3\":\"05\",\"4\":\"00068085\",\"5\":\"05\",\"6\":\"AR\",\"7\":\"Arkansas\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.346608e+11\",\"12\":\"3121950081\",\"13\":\"+34.8955256\",\"14\":\"-092.4446262\",\"15\":\"40480\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"6\",\"3\":\"28\",\"4\":\"01779790\",\"5\":\"28\",\"6\":\"MS\",\"7\":\"Mississippi\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.215339e+11\",\"12\":\"3914344129\",\"13\":\"+32.6864714\",\"14\":\"-089.6561377\",\"15\":\"34880\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"29\",\"4\":\"01779791\",\"5\":\"29\",\"6\":\"MO\",\"7\":\"Missouri\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.780523e+11\",\"12\":\"2487445715\",\"13\":\"+38.3507500\",\"14\":\"-092.4567826\",\"15\":\"35510\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"30\",\"4\":\"00767982\",\"5\":\"30\",\"6\":\"MT\",\"7\":\"Montana\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"3.769737e+11\",\"12\":\"3866634365\",\"13\":\"+47.0511770\",\"14\":\"-109.6348174\",\"15\":\"37710\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"20\",\"4\":\"00481813\",\"5\":\"20\",\"6\":\"KS\",\"7\":\"Kansas\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.117537e+11\",\"12\":\"1345767737\",\"13\":\"+38.4985464\",\"14\":\"-098.3834298\",\"15\":\"41050\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"3\",\"3\":\"18\",\"4\":\"00448508\",\"5\":\"18\",\"6\":\"IN\",\"7\":\"Indiana\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"9.278936e+10\",\"12\":\"1541248299\",\"13\":\"+39.9013136\",\"14\":\"-086.2919129\",\"15\":\"42100\",\"16\":\"<s_MULTIP>\"},{\"1\":\"9\",\"2\":\"0\",\"3\":\"72\",\"4\":\"01779808\",\"5\":\"72\",\"6\":\"PR\",\"7\":\"Puerto Rico\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"8.869136e+09\",\"12\":\"4922143005\",\"13\":\"+18.2176480\",\"14\":\"-066.4107992\",\"15\":\"23050\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"46\",\"4\":\"01785534\",\"5\":\"46\",\"6\":\"SD\",\"7\":\"South Dakota\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.963429e+11\",\"12\":\"3386737669\",\"13\":\"+44.4467957\",\"14\":\"-100.2381762\",\"15\":\"36980\",\"16\":\"<s_MULTIP>\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"25\",\"4\":\"00606926\",\"5\":\"25\",\"6\":\"MA\",\"7\":\"Massachusetts\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.020439e+10\",\"12\":\"7130660432\",\"13\":\"+42.1565196\",\"14\":\"-071.4895915\",\"15\":\"44960\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"51\",\"4\":\"01779803\",\"5\":\"51\",\"6\":\"VA\",\"7\":\"Virginia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.022582e+11\",\"12\":\"8528040726\",\"13\":\"+37.5222512\",\"14\":\"-078.6681938\",\"15\":\"49250\",\"16\":\"<s_MULTIP>\"},{\"1\":\"3\",\"2\":\"5\",\"3\":\"11\",\"4\":\"01702382\",\"5\":\"11\",\"6\":\"DC\",\"7\":\"District of Columbia\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.583161e+08\",\"12\":\"18709762\",\"13\":\"+38.9042474\",\"14\":\"-077.0165167\",\"15\":\"57210\",\"16\":\"<s_MULTIP>\"},{\"1\":\"2\",\"2\":\"4\",\"3\":\"19\",\"4\":\"01779785\",\"5\":\"19\",\"6\":\"IA\",\"7\":\"Iowa\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"1.446597e+11\",\"12\":\"1085964740\",\"13\":\"+42.0700243\",\"14\":\"-093.4933473\",\"15\":\"45380\",\"16\":\"<s_MULTIP>\"},{\"1\":\"4\",\"2\":\"8\",\"3\":\"04\",\"4\":\"01779777\",\"5\":\"04\",\"6\":\"AZ\",\"7\":\"Arizona\",\"8\":\"00\",\"9\":\"G4000\",\"10\":\"A\",\"11\":\"2.943640e+11\",\"12\":\"855871553\",\"13\":\"+34.2039362\",\"14\":\"-111.6063449\",\"15\":\"34560\",\"16\":\"<s_MULTIP>\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Quick Thematic Map\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqtm(HelperShapeObject, fill = \"wages\")\n```\n\n::: {.cell-output-display}\n![](031_thematic_mapping_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## 50 states\n\nFilter to only the contiguous 50 states + D.C. Note that `tigris::shift_geometry()` will shift and resize Alaska and Hawaii.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontiguous_states <- HelperShapeObject %>% \n  filter(REGION != 9) %>% \n  shift_geometry()\n```\n:::\n\n\n## Make Choropleth\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(contiguous_states) +\n  tm_polygons(\"wages\", id = \"Name\")\n```\n\n::: {.cell-output-display}\n![](031_thematic_mapping_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Projection\n\nMark likes the USA_Contiguous_Albers_Equal_Area_Conic_USGS_version projection for the continental US. `EPSG:5070`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontiguous_states %>% \n  st_transform(5070) %>% \n  tm_shape() +\n  tm_polygons(\"wages\", id = \"Name\") \n```\n\n::: {.cell-output-display}\n![](031_thematic_mapping_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### Alternative Syntax\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(contiguous_states, projection = 5070) +\n  tm_polygons(\"wages\", id = \"Name\")\n```\n\n::: {.cell-output-display}\n![](031_thematic_mapping_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### Explore `tmap` syntax and functions\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(contiguous_states, projection = 5070) +\n  tm_borders(col = \"black\", alpha = 0.4) +\n  tm_fill(col = \"REGION\", alpha = 0.6) +\n  tm_layout(title = \"Regions of the USA\", \n                  attr.color = \"navy\", \n                  title.position = c(\"center\", \"top\"), \n                  title.bg.color = \"lightblue\")\n```\n\n::: {.cell-output-display}\n![](031_thematic_mapping_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## End Notes\n\nThis session inspired by https://www.computerworld.com/article/3175623/data-analytics/mapping-in-r-just-got-a-whole-lot-easier.html\n",
    "supporting": [
      "031_thematic_mapping_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}