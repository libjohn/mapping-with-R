!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).flatgeobuf={})}(this,(function(t){"use strict";var e;!function(t){t[t.Byte=0]="Byte",t[t.UByte=1]="UByte",t[t.Bool=2]="Bool",t[t.Short=3]="Short",t[t.UShort=4]="UShort",t[t.Int=5]="Int",t[t.UInt=6]="UInt",t[t.Long=7]="Long",t[t.ULong=8]="ULong",t[t.Float=9]="Float",t[t.Double=10]="Double",t[t.String=11]="String",t[t.Json=12]="Json",t[t.DateTime=13]="DateTime",t[t.Binary=14]="Binary"}(e||(e={}));var r=e;const i={[r.Byte]:Uint8Array,[r.UByte]:Uint8Array,[r.Bool]:Uint8Array,[r.Short]:Uint16Array,[r.UShort]:Uint16Array,[r.Int]:Uint32Array,[r.UInt]:Uint32Array,[r.Long]:BigUint64Array,[r.ULong]:BigUint64Array,[r.Double]:Float64Array};class n{constructor(t,e){this.name=t,this.type=e,this.arrayType=i[e]}}class s{constructor(t,e,r){this.geometryType=t,this.columns=e,this.featuresCount=r}}var o,a,b,h,u={};u.SIZEOF_SHORT=2,u.SIZEOF_INT=4,u.FILE_IDENTIFIER_LENGTH=4,u.SIZE_PREFIX_LENGTH=4,u.Encoding={UTF8_BYTES:1,UTF16_STRING:2},u.int32=new Int32Array(2),u.float32=new Float32Array(u.int32.buffer),u.float64=new Float64Array(u.int32.buffer),u.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],u.Long=function(t,e){this.low=0|t,this.high=0|e},u.Long.create=function(t,e){return 0==t&&0==e?u.Long.ZERO:new u.Long(t,e)},u.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},u.Long.prototype.equals=function(t){return this.low==t.low&&this.high==t.high},u.Long.ZERO=new u.Long(0,0),u.Builder=function(t){if(t)e=t;else var e=1024;this.bb=u.ByteBuffer.allocate(e),this.space=e,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},u.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},u.Builder.prototype.forceDefaults=function(t){this.force_defaults=t},u.Builder.prototype.dataBuffer=function(){return this.bb},u.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},u.Builder.prototype.prep=function(t,e){t>this.minalign&&(this.minalign=t);for(var r=1+~(this.bb.capacity()-this.space+e)&t-1;this.space<r+t+e;){var i=this.bb.capacity();this.bb=u.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(r)},u.Builder.prototype.pad=function(t){for(var e=0;e<t;e++)this.bb.writeInt8(--this.space,0)},u.Builder.prototype.writeInt8=function(t){this.bb.writeInt8(this.space-=1,t)},u.Builder.prototype.writeInt16=function(t){this.bb.writeInt16(this.space-=2,t)},u.Builder.prototype.writeInt32=function(t){this.bb.writeInt32(this.space-=4,t)},u.Builder.prototype.writeInt64=function(t){this.bb.writeInt64(this.space-=8,t)},u.Builder.prototype.writeFloat32=function(t){this.bb.writeFloat32(this.space-=4,t)},u.Builder.prototype.writeFloat64=function(t){this.bb.writeFloat64(this.space-=8,t)},u.Builder.prototype.addInt8=function(t){this.prep(1,0),this.writeInt8(t)},u.Builder.prototype.addInt16=function(t){this.prep(2,0),this.writeInt16(t)},u.Builder.prototype.addInt32=function(t){this.prep(4,0),this.writeInt32(t)},u.Builder.prototype.addInt64=function(t){this.prep(8,0),this.writeInt64(t)},u.Builder.prototype.addFloat32=function(t){this.prep(4,0),this.writeFloat32(t)},u.Builder.prototype.addFloat64=function(t){this.prep(8,0),this.writeFloat64(t)},u.Builder.prototype.addFieldInt8=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt8(e),this.slot(t))},u.Builder.prototype.addFieldInt16=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt16(e),this.slot(t))},u.Builder.prototype.addFieldInt32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt32(e),this.slot(t))},u.Builder.prototype.addFieldInt64=function(t,e,r){!this.force_defaults&&e.equals(r)||(this.addInt64(e),this.slot(t))},u.Builder.prototype.addFieldFloat32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat32(e),this.slot(t))},u.Builder.prototype.addFieldFloat64=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat64(e),this.slot(t))},u.Builder.prototype.addFieldOffset=function(t,e,r){(this.force_defaults||e!=r)&&(this.addOffset(e),this.slot(t))},u.Builder.prototype.addFieldStruct=function(t,e,r){e!=r&&(this.nested(e),this.slot(t))},u.Builder.prototype.nested=function(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},u.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},u.Builder.prototype.slot=function(t){this.vtable[t]=this.offset()},u.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},u.Builder.growByteBuffer=function(t){var e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=e<<1,i=u.ByteBuffer.allocate(r);return i.setPosition(r-e),i.bytes().set(t.bytes(),r-e),i},u.Builder.prototype.addOffset=function(t){this.prep(u.SIZEOF_INT,0),this.writeInt32(this.offset()-t+u.SIZEOF_INT)},u.Builder.prototype.startObject=function(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(var e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()},u.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var t=this.offset(),e=this.vtable_in_use-1;e>=0&&0==this.vtable[e];e--);for(var r=e+1;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);var i=(r+2)*u.SIZEOF_SHORT;this.addInt16(i);var n=0,s=this.space;t:for(e=0;e<this.vtables.length;e++){var o=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(o)){for(var a=u.SIZEOF_SHORT;a<i;a+=u.SIZEOF_SHORT)if(this.bb.readInt16(s+a)!=this.bb.readInt16(o+a))continue t;n=this.vtables[e];break}}return n?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,n-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t},u.Builder.prototype.finish=function(t,e,r){var i=r?u.SIZE_PREFIX_LENGTH:0;if(e){var n=e;if(this.prep(this.minalign,u.SIZEOF_INT+u.FILE_IDENTIFIER_LENGTH+i),n.length!=u.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+u.FILE_IDENTIFIER_LENGTH);for(var s=u.FILE_IDENTIFIER_LENGTH-1;s>=0;s--)this.writeInt8(n.charCodeAt(s))}this.prep(this.minalign,u.SIZEOF_INT+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},u.Builder.prototype.finishSizePrefixed=function(t,e){this.finish(t,e,!0)},u.Builder.prototype.requiredField=function(t,e){var r=this.bb.capacity()-t,i=r-this.bb.readInt32(r);if(!(0!=this.bb.readInt16(i+e)))throw new Error("FlatBuffers: field "+e+" must be set")},u.Builder.prototype.startVector=function(t,e,r){this.notNested(),this.vector_num_elems=e,this.prep(u.SIZEOF_INT,t*e),this.prep(r,t*e)},u.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},u.Builder.prototype.createString=function(t){if(t instanceof Uint8Array)var e=t;else{e=[];for(var r=0;r<t.length;){var i,n=t.charCodeAt(r++);if(n<55296||n>=56320)i=n;else i=(n<<10)+t.charCodeAt(r++)+-56613888;i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(63&i|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);r=0;for(var s=this.space,o=this.bb.bytes();r<e.length;r++)o[s++]=e[r];return this.endVector()},u.Builder.prototype.createLong=function(t,e){return u.Long.create(t,e)},u.ByteBuffer=function(t){this.bytes_=t,this.position_=0},u.ByteBuffer.allocate=function(t){return new u.ByteBuffer(new Uint8Array(t))},u.ByteBuffer.prototype.clear=function(){this.position_=0},u.ByteBuffer.prototype.bytes=function(){return this.bytes_},u.ByteBuffer.prototype.position=function(){return this.position_},u.ByteBuffer.prototype.setPosition=function(t){this.position_=t},u.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},u.ByteBuffer.prototype.readInt8=function(t){return this.readUint8(t)<<24>>24},u.ByteBuffer.prototype.readUint8=function(t){return this.bytes_[t]},u.ByteBuffer.prototype.readInt16=function(t){return this.readUint16(t)<<16>>16},u.ByteBuffer.prototype.readUint16=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8},u.ByteBuffer.prototype.readInt32=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24},u.ByteBuffer.prototype.readUint32=function(t){return this.readInt32(t)>>>0},u.ByteBuffer.prototype.readInt64=function(t){return new u.Long(this.readInt32(t),this.readInt32(t+4))},u.ByteBuffer.prototype.readUint64=function(t){return new u.Long(this.readUint32(t),this.readUint32(t+4))},u.ByteBuffer.prototype.readFloat32=function(t){return u.int32[0]=this.readInt32(t),u.float32[0]},u.ByteBuffer.prototype.readFloat64=function(t){return u.int32[u.isLittleEndian?0:1]=this.readInt32(t),u.int32[u.isLittleEndian?1:0]=this.readInt32(t+4),u.float64[0]},u.ByteBuffer.prototype.writeInt8=function(t,e){this.bytes_[t]=e},u.ByteBuffer.prototype.writeUint8=function(t,e){this.bytes_[t]=e},u.ByteBuffer.prototype.writeInt16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8},u.ByteBuffer.prototype.writeUint16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8},u.ByteBuffer.prototype.writeInt32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24},u.ByteBuffer.prototype.writeUint32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24},u.ByteBuffer.prototype.writeInt64=function(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)},u.ByteBuffer.prototype.writeUint64=function(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)},u.ByteBuffer.prototype.writeFloat32=function(t,e){u.float32[0]=e,this.writeInt32(t,u.int32[0])},u.ByteBuffer.prototype.writeFloat64=function(t,e){u.float64[0]=e,this.writeInt32(t,u.int32[u.isLittleEndian?0:1]),this.writeInt32(t+4,u.int32[u.isLittleEndian?1:0])},u.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+u.SIZEOF_INT+u.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var t="",e=0;e<u.FILE_IDENTIFIER_LENGTH;e++)t+=String.fromCharCode(this.readInt8(this.position_+u.SIZEOF_INT+e));return t},u.ByteBuffer.prototype.__offset=function(t,e){var r=t-this.readInt32(t);return e<this.readInt16(r)?this.readInt16(r+e):0},u.ByteBuffer.prototype.__union=function(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t},u.ByteBuffer.prototype.__string=function(t,e){t+=this.readInt32(t);var r=this.readInt32(t),i="",n=0;if(t+=u.SIZEOF_INT,e===u.Encoding.UTF8_BYTES)return this.bytes_.subarray(t,t+r);for(;n<r;){var s,o=this.readUint8(t+n++);if(o<192)s=o;else{var a=this.readUint8(t+n++);if(o<224)s=(31&o)<<6|63&a;else{var b=this.readUint8(t+n++);if(o<240)s=(15&o)<<12|(63&a)<<6|63&b;else s=(7&o)<<18|(63&a)<<12|(63&b)<<6|63&this.readUint8(t+n++)}}s<65536?i+=String.fromCharCode(s):(s-=65536,i+=String.fromCharCode(55296+(s>>10),56320+(1023&s)))}return i},u.ByteBuffer.prototype.__indirect=function(t){return t+this.readInt32(t)},u.ByteBuffer.prototype.__vector=function(t){return t+this.readInt32(t)+u.SIZEOF_INT},u.ByteBuffer.prototype.__vector_len=function(t){return this.readInt32(t+this.readInt32(t))},u.ByteBuffer.prototype.__has_identifier=function(t){if(t.length!=u.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+u.FILE_IDENTIFIER_LENGTH);for(var e=0;e<u.FILE_IDENTIFIER_LENGTH;e++)if(t.charCodeAt(e)!=this.readInt8(this.position_+u.SIZEOF_INT+e))return!1;return!0},u.ByteBuffer.prototype.createLong=function(t,e){return u.Long.create(t,e)},function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon",t[t.MultiPoint=4]="MultiPoint",t[t.MultiLineString=5]="MultiLineString",t[t.MultiPolygon=6]="MultiPolygon",t[t.GeometryCollection=7]="GeometryCollection",t[t.CircularString=8]="CircularString",t[t.CompoundCurve=9]="CompoundCurve",t[t.CurvePolygon=10]="CurvePolygon",t[t.MultiCurve=11]="MultiCurve",t[t.MultiSurface=12]="MultiSurface",t[t.Curve=13]="Curve",t[t.Surface=14]="Surface",t[t.PolyhedralSurface=15]="PolyhedralSurface",t[t.TIN=16]="TIN",t[t.Triangle=17]="Triangle"}(o||(o={})),function(t){t[t.Byte=0]="Byte",t[t.UByte=1]="UByte",t[t.Bool=2]="Bool",t[t.Short=3]="Short",t[t.UShort=4]="UShort",t[t.Int=5]="Int",t[t.UInt=6]="UInt",t[t.Long=7]="Long",t[t.ULong=8]="ULong",t[t.Float=9]="Float",t[t.Double=10]="Double",t[t.String=11]="String",t[t.Json=12]="Json",t[t.DateTime=13]="DateTime",t[t.Binary=14]="Binary"}(a||(a={}));class f{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new f).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return t.setPosition(t.position()+u.SIZE_PREFIX_LENGTH),(e||new f).__init(t.readInt32(t.position())+t.position(),t)}name(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):a.Byte}static start(t){t.startObject(2)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,a.Byte)}static end(t){var e=t.endObject();return t.requiredField(e,4),e}static create(t,e,r){return f.start(t),f.addName(t,e),f.addType(t,r),f.end(t)}}class c{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new c).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return t.setPosition(t.position()+u.SIZE_PREFIX_LENGTH),(e||new c).__init(t.readInt32(t.position())+t.position(),t)}org(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}static start(t){t.startObject(5)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static end(t){return t.endObject()}static create(t,e,r,i,n,s){return c.start(t),c.addOrg(t,e),c.addCode(t,r),c.addName(t,i),c.addDescription(t,n),c.addWkt(t,s),c.end(t)}}class d{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new d).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return t.setPosition(t.position()+u.SIZE_PREFIX_LENGTH),(e||new d).__init(t.readInt32(t.position())+t.position(),t)}name(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}envelopeLength(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){var t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):o.Unknown}hasZ(){var t=this.bb.__offset(this.bb_pos,10);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasM(){var t=this.bb.__offset(this.bb_pos,12);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasT(){var t=this.bb.__offset(this.bb_pos,14);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasTM(){var t=this.bb.__offset(this.bb_pos,16);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}columns(t,e){var r=this.bb.__offset(this.bb_pos,18);return r?(e||new f).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}columnsLength(){var t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){var t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):this.bb.createLong(0,0)}indexNodeSize(){var t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){var e=this.bb.__offset(this.bb_pos,24);return e?(t||new c).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static start(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,o.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTM(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,t.createLong(0,0))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static end(t){return t.endObject()}static finishBuffer(t,e){t.finish(e)}static finishSizePrefixedBuffer(t,e){t.finish(e,void 0,!0)}static create(t,e,r,i,n,s,o,a,b,h,u,f){return d.start(t),d.addName(t,e),d.addEnvelope(t,r),d.addGeometryType(t,i),d.addHasZ(t,n),d.addHasM(t,s),d.addHasT(t,o),d.addHasTM(t,a),d.addColumns(t,b),d.addFeaturesCount(t,h),d.addIndexNodeSize(t,u),d.addCrs(t,f),d.end(t)}}!function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon",t[t.MultiPoint=4]="MultiPoint",t[t.MultiLineString=5]="MultiLineString",t[t.MultiPolygon=6]="MultiPolygon",t[t.GeometryCollection=7]="GeometryCollection",t[t.CircularString=8]="CircularString",t[t.CompoundCurve=9]="CompoundCurve",t[t.CurvePolygon=10]="CurvePolygon",t[t.MultiCurve=11]="MultiCurve",t[t.MultiSurface=12]="MultiSurface",t[t.Curve=13]="Curve",t[t.Surface=14]="Surface",t[t.PolyhedralSurface=15]="PolyhedralSurface",t[t.TIN=16]="TIN",t[t.Triangle=17]="Triangle"}(b||(b={})),function(t){t[t.Byte=0]="Byte",t[t.UByte=1]="UByte",t[t.Bool=2]="Bool",t[t.Short=3]="Short",t[t.UShort=4]="UShort",t[t.Int=5]="Int",t[t.UInt=6]="UInt",t[t.Long=7]="Long",t[t.ULong=8]="ULong",t[t.Float=9]="Float",t[t.Double=10]="Double",t[t.String=11]="String",t[t.Json=12]="Json",t[t.DateTime=13]="DateTime",t[t.Binary=14]="Binary"}(h||(h={}));class l{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new l).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return t.setPosition(t.position()+u.SIZE_PREFIX_LENGTH),(e||new l).__init(t.readInt32(t.position())+t.position(),t)}name(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):h.Byte}static start(t){t.startObject(2)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,h.Byte)}static end(t){var e=t.endObject();return t.requiredField(e,4),e}static create(t,e,r){return l.start(t),l.addName(t,e),l.addType(t,r),l.end(t)}}class _{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new _).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return t.setPosition(t.position()+u.SIZE_PREFIX_LENGTH),(e||new _).__init(t.readInt32(t.position())+t.position(),t)}ends(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+4*t):0}endsLength(){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){var t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}xyLength(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){var t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}zLength(){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){var t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}mLength(){var t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){var t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}tLength(){var t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){var t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}tmLength(){var t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){var t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):b.Unknown}parts(t,e){var r=this.bb.__offset(this.bb_pos,18);return r?(e||new _).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}partsLength(){var t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static start(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addInt32(e[r]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addInt64(e[r]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,b.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static end(t){return t.endObject()}static create(t,e,r,i,n,s,o,a,b){return _.start(t),_.addEnds(t,e),_.addXy(t,r),_.addZ(t,i),_.addM(t,n),_.addT(t,s),_.addTm(t,o),_.addType(t,a),_.addParts(t,b),_.end(t)}}class p{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new p).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return t.setPosition(t.position()+u.SIZE_PREFIX_LENGTH),(e||new p).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){var e=this.bb.__offset(this.bb_pos,4);return e?(t||new _).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){var t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){var r=this.bb.__offset(this.bb_pos,8);return r?(e||new l).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}columnsLength(){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static start(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(var r=e.length-1;r>=0;r--)t.addInt8(e[r]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static end(t){return t.endObject()}static finishBuffer(t,e){t.finish(e)}static finishSizePrefixedBuffer(t,e){t.finish(e,void 0,!0)}static create(t,e,r,i){return p.start(t),p.addGeometry(t,e),p.addProperties(t,r),p.addColumns(t,i),p.end(t)}}function y(t){return t.reduce((t,e)=>Array.isArray(e)?t.concat(y(e)):t.concat(e),[])}function g(t){const e=[];for(let r=0;r<t.length;r+=2)e.push([t[r],t[r+1]]);return e}function I(t){return o[t]}function v(t){const e=t.coordinates;let r=null,i=null,n=null;const s=I(t.type);let o=0;switch(t.type){case"Point":r=e;break;case"MultiPoint":case"LineString":r=y(e);break;case"MultiLineString":case"Polygon":{const t=e;r=y(t),t.length>1&&(i=t.map(t=>o+=t.length));break}case"MultiPolygon":n=e.map(t=>({type:"Polygon",coordinates:t})).map(v);break;case"GeometryCollection":n=t.geometries.map(v)}return{xy:r,ends:i,type:s,parts:n}}function B(t,e){if(!e||0===e.length)return[g(t)];let r=0;return Array.from(e).map(e=>t.slice(r,r=e<<1)).map(t=>g(t))}function w(t,e){if(e==o.GeometryCollection){const r=[];for(let e=0;e<t.partsLength();e++){const i=t.parts(e),n=i.type();r.push(w(i,n))}return{type:o[e],geometries:r}}if(e==o.MultiPolygon){const r=[];for(let e=0;e<t.partsLength();e++){const i=t.parts(e);r.push(w(i,o.Polygon))}return{type:o[e],coordinates:r.map(t=>t.coordinates)}}const r=function(t,e){const r=t.xyArray();switch(e){case o.Point:return Array.from(r);case o.MultiPoint:case o.LineString:return g(r);case o.MultiLineString:case o.Polygon:return B(r,t.endsArray())}}(t,e);return{type:o[e],coordinates:r}}const m=new TextEncoder,F=new TextDecoder;function U(t,e,i){const n=i.columns,s=new u.Builder,o=[];if(n)for(let t=0;t<n.length;t++){const i=n[t],s=e[i.name];if(null!==s)switch(o.push(Uint16Array.of(t)),i.type){case r.Bool:case r.Short:case r.UShort:case r.Int:case r.UInt:case r.Long:case r.Double:o.push(i.arrayType.of(s));break;case r.DateTime:case r.String:{const t=m.encode(s);o.push(Uint32Array.of(t.length)),o.push(t);break}default:throw new Error("Unknown type "+i.type)}}let a=null;o.length>0&&(a=p.createPropertiesVector(s,function(t,...e){let r=0;for(const t of e)r+=t.byteLength;const i=new t(r);let n=0;for(const r of e)r instanceof Uint8Array?i.set(r,n):i.set(new t(r.buffer),n),n+=r.byteLength;return i}(Uint8Array,...o)));const b=function t(e,r){const{xy:i,ends:n,parts:s,type:o}=r;if(s){const r=s.map(r=>t(e,r)),i=_.createPartsVector(e,r);return _.start(e),_.addParts(e,i),_.end(e)}const a=_.createXyVector(e,i);let b=null;return n&&(b=_.createEndsVector(e,n)),_.start(e),b&&_.addEnds(e,b),_.addXy(e,a),_.addType(e,o),_.end(e)}(s,t);p.start(s),p.addGeometry(s,b),a&&p.addProperties(s,a);const h=p.end(s);return s.finishSizePrefixed(h),s.asUint8Array()}function E(t,e){const i=e.columns,n=w(t.geometry(),e.geometryType),s=function(t,e){if(!e||0===e.length)return;const i=t.propertiesArray(),n=new DataView(i.buffer,i.byteOffset),s=t.propertiesLength();let o=0;const a={};for(;o<s;){const t=n.getUint16(o,!0);o+=2;const s=e[t];switch(s.type){case r.Bool:a[s.name]=!!n.getUint8(o),o+=1;break;case r.Byte:a[s.name]=n.getInt8(o),o+=1;break;case r.UByte:a[s.name]=n.getUint8(o),o+=1;break;case r.Short:a[s.name]=n.getInt16(o,!0),o+=2;break;case r.UShort:a[s.name]=n.getUint16(o,!0),o+=2;break;case r.Int:a[s.name]=n.getInt32(o,!0),o+=4;break;case r.UInt:a[s.name]=n.getUint32(o,!0),o+=4;break;case r.Long:a[s.name]=Number(n.getBigInt64(o,!0)),o+=8;break;case r.ULong:a[s.name]=Number(n.getBigUint64(o,!0)),o+=8;break;case r.Double:a[s.name]=n.getFloat64(o,!0),o+=8;break;case r.DateTime:case r.String:{const t=n.getUint32(o,!0);o+=4,a[s.name]=F.decode(i.subarray(o,o+t)),o+=t;break}default:throw new Error("Unknown type "+s.type)}}return a}(t,i),o={type:"Feature",geometry:n};return s&&(o.properties=s),o}var S=new Uint8Array(0);function L(t,e){if(!t.length)return e;if(!e.length)return t;var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function T(t){this._source=t,this._array=S,this._index=0}T.prototype.read=function(){var t=this,e=t._array.subarray(t._index);return t._source.read().then((function(r){return t._array=S,t._index=0,r.done?e.length>0?{done:!1,value:e}:{done:!0,value:void 0}:{done:!1,value:L(e,r.value)}}))},T.prototype.slice=function(t){if((t|=0)<0)throw new Error("invalid length");var e=this,r=this._array.length-this._index;if(this._index+t<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=t));var i=new Uint8Array(t);return i.set(this._array.subarray(this._index)),function n(){return e._source.read().then((function(s){return s.done?(e._array=S,e._index=0,r>0?i.subarray(0,r):null):r+s.value.length>=t?(e._array=s.value,e._index=t-r,i.set(s.value.subarray(0,t-r),r),i):(i.set(s.value,r),r+=s.value.length,n())}))}()},T.prototype.cancel=function(){return this._source.cancel()};function P(t,e){e=Math.min(Math.max(+e,2),65535);let r=t,i=r;do{r=Math.ceil(r/e),i+=r}while(1!==r);return 40*i}async function*O(t,e,r,i){const{minX:n,minY:s,maxX:o,maxY:a}=r,b=function(t,e){if(e<2)throw new Error("Node size must be at least 2");if(0===t)throw new Error("Number of items must be greater than 0");let r=t,i=r;const n=[r];do{r=Math.ceil(r/e),i+=r,n.push(r)}while(1!==r);const s=[];r=i;for(const t of n)s.push(r-t),r-=t;s.reverse(),n.reverse();const o=[];for(let t=0;t<n.length;t++)o.push([s[t],s[t]+n[t]]);return o.reverse(),o}(t,e),[[h,u]]=b,f=[];for(f.push([0,b.length-1]);0!==f.length;){const[r,c]=f.pop(),d=r>=u-t,[,l]=b[c],_=Math.min(r+e,l),p=_-r,y=await i(40*r,40*p),g=new Float64Array(y),I=new Uint32Array(y);for(let t=r;t<_;t++){const e=5*(t-r);if(o<g[e+0])continue;if(a<g[e+1])continue;if(n>g[e+2])continue;if(s>g[e+3])continue;const i=I[8+(e<<1)];d?yield[i,t-h]:f.push([i,c-1])}f.sort((t,e)=>e[0]-t[0])}}const N=new Uint8Array([102,103,98,3,102,103,98,0]);function V(t,e,r){const i="function"==typeof(n=t).slice?n:new T("function"==typeof n.read?n:n.getReader());var n;return A(async t=>await i.slice(t),void 0,void 0,e,r)}async function*A(t,e,r,i,o){let a=0,b=new Uint8Array(await t(8));if(a+=8,!b.every((t,e)=>N[e]===t))throw new Error("Not a FlatGeobuf file");b=new Uint8Array(await t(4)),a+=4;let h=new u.ByteBuffer(b);const f=h.readUint32(0);b=new Uint8Array(await t(f)),a+=f,h=new u.ByteBuffer(b);const c=d.getRoot(h),l=c.featuresCount().toFloat64(),_=[];for(let t=0;t<c.columnsLength();t++){const e=c.columns(t);_.push(new n(e.name(),e.type()))}const p=new s(c.geometryType(),_,l);o&&o(p);const y=c.indexNodeSize();if(y>0){const n=P(l,y);if(r){const s=async(r,i)=>(await e(a+r),await t(i)),o=[];for await(const[t]of O(l,y,r,s))o.push(t);a+=n;for await(const r of o)await e(a+r),yield await C(t,p,i);return}e?await e(a+n):await t(n),a+=n}let g;for(;g=await C(t,p,i);)yield g}async function C(t,e,r){let i=new Uint8Array(await t(4));if(0===i.byteLength)return null;let n=new u.ByteBuffer(i);const s=n.readUint32(0);i=new Uint8Array(await t(s));const o=new Uint8Array(s+4);o.set(i,4),n=new u.ByteBuffer(o),n.setPosition(4);return r(p.getRoot(n),e)}function R(t){const e=new u.Builder;let r=null;t.columns&&(r=d.createColumnsVector(e,t.columns.map(t=>function(t,e){const r=t.createString(e.name);return f.start(t),f.addName(t,r),f.addType(t,e.type),f.end(t)}(e,t))));const i=e.createString("L1");d.start(e),d.addFeaturesCount(e,new u.Long(t.featuresCount,0)),d.addGeometryType(e,t.geometryType),d.addIndexNodeSize(e,0),r&&d.addColumns(e,r),d.addName(e,i);const n=d.end(e);return e.finishSizePrefixed(n),e.asUint8Array()}function M(t){const e=function(t){const e=t.features[0],i=e.properties;let o=null;i&&(o=Object.keys(i).map(t=>new n(t,function(t){if("boolean"==typeof t)return r.Bool;if("number"==typeof t)return t%1==0?r.Int:r.Double;if("string"==typeof t)return r.String;if(null===t)return r.String;throw new Error(`Unknown type (value '${t}')`)}(i[t]))));return new s(I(e.geometry.type),o,t.features.length)}(t),i=R(e),o=t.features.map(t=>U(v(t.geometry),t.properties,e)),a=o.map(t=>t.length).reduce((t,e)=>t+e),b=new Uint8Array(N.length+i.length+a);b.set(i,N.length);let h=N.length+i.length;for(const t of o)b.set(t,h),h+=t.length;return b.set(N),b}function x(t,e){return{type:"FeatureCollection",features:function(t,e,r){if(!t.subarray(0,7).every((t,e)=>N[e]===t))throw new Error("Not a FlatGeobuf file");const i=new u.ByteBuffer(t),o=i.readUint32(N.length);i.setPosition(N.length+4);const a=d.getRoot(i),b=a.featuresCount().toFloat64(),h=[];for(let t=0;t<a.columnsLength();t++){const e=a.columns(t);h.push(new n(e.name(),e.type()))}const f=new s(a.geometryType(),h,0);r&&r(f);let c=N.length+4+o;const l=a.indexNodeSize();l>0&&(c+=P(b,l));const _=[];for(;c<i.capacity();){const t=i.readUint32(c);i.setPosition(c+4);const r=p.getRoot(i);_.push(e(r,f)),c+=4+t}return _}(t,(t,e)=>E(t,e),e)}}function k(t,e,r){return function(t,e,r,i){let n=0;return A(async e=>{const r=await fetch(t,{headers:{Range:`bytes=${n}-${n+e-1}`}});n+=e;return await r.arrayBuffer()},async t=>{n=t},e,r,i)}(t,e,(t,e)=>E(t,e),r)}t.deserialize=function(t,e,r){return t instanceof Uint8Array?x(t,r):t instanceof ReadableStream?function(t,e){return V(t,(t,e)=>E(t,e),e)}(t,r):k(t,e,r)},t.serialize=function(t){return M(t)},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=flatgeobuf-geojson.min.js.map
